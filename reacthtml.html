<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
    <title>간단한 지도 표시하기</title>
    <script type="text/javascript"
        src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=uzlzuhd2pa&submodules=panorama"></script>
    <script src="https://requirejs.org/docs/release/2.3.5/minified/require.js"></script>
    <script type='module' src="/node_modules/requirejs/require.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.js"
        integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
</head>

<body>
    <div id="map" style="width:100%;height:400px;"></div>
    <div id="pano" style="width:100%;height:400px;"></div>
    <script>
        var map = new naver.maps.Map('map', {
            center: new naver.maps.LatLng(37.3595704, 127.105399),
            zoom: 13,
            minZoom: 6,
            mapTypeId: naver.maps.MapTypeId.HYBRID,
            zoomControl: true,
            zoomControlOptions: {
                position: naver.maps.Position.TOP_RIGHT
            },
            mapDataControl: false,
            logoControlOptions: {
                position: naver.maps.Position.LEFT_BOTTOM
            },
            disableKineticPan: false,
            mapTypeControl: true
        });
        
        var HOME_PATH = window.HOME_PATH || '.';
        console.log(HOME_PATH);
        var slat = 37.3595704;
        var slong = 127.105399;
        var elat = 37.2762087;
        var elong = 127.0808982;
        var position = new naver.maps.LatLng(slat, slong);
        var pano = null;
        naver.maps.onJSContentLoaded = function () {
            // 아이디 혹은 지도 좌표로 파노라마를 표시할 수 있습니다.
            pano = new naver.maps.Panorama("pano", {
                position: new naver.maps.LatLng(37.3599605, 127.1058814),
                pov: {
                    pan: -133,
                    tilt: 0,
                    fov: 100
                }
            });

            // 파노라마 위치가 갱신되었을 때 발생하는 이벤트를 받아 지도의 중심 위치를 갱신합니다.
            naver.maps.Event.addListener(pano, 'click', function () {
                var latlng = pano.getPosition();

                if (!latlng.equals(map.getCenter())) {
                    map.setCenter(latlng);
                }
            });
        };
        // 거리뷰 레이어를 생성합니다.
        var streetLayer = new naver.maps.StreetLayer();
        naver.maps.Event.once(map, 'init_stylemap', function () {
            streetLayer.setMap(map);
        });
        // 거리뷰 버튼에 이벤트를 바인딩합니다.
        var btn = $('#street');
        btn.on("click", function (e) {
            e.preventDefault();

            // 거리뷰 레이어가 지도 위에 있으면 거리뷰 레이어를 지도에서 제거하고,
            // 거리뷰 레이어가 지도 위에 없으면 거리뷰 레이어를 지도에 추가합니다.
            if (streetLayer.getMap()) {
                streetLayer.setMap(null);
            } else {
                streetLayer.setMap(map);
            }
        });

        // 거리뷰 레이어가 변경되면 발생하는 이벤트를 지도로부터 받아 버튼의 상태를 변경합니다.
        naver.maps.Event.addListener(map, 'streetLayer_changed', function (streetLayer) {
            if (streetLayer) {
                btn.addClass('control-on');
            } else {
                btn.removeClass('control-on');
            }
        });
        const arr = [
            [127.1054006, 37.359904], [127.1058354, 37.3599018], [127.1059935, 37.3599014], [127.1058354, 37.3599018], [127.1052888, 37.3599045], [127.1052199, 37.3599061], [127.1046632, 37.3599024], [127.1045266, 37.359901], [127.1044453, 37.3599017], [127.1041189, 37.3599042], [127.1041152, 37.3595445], [127.1041123, 37.3583826], [127.1041114, 37.3578995], [127.1041247, 37.3566583], [127.1041362, 37.3553198], [127.1041455, 37.3541994], [127.1041471, 37.3539074], [127.104149, 37.3533161], [127.1041745, 37.3506246], [127.1041729, 37.350484], [127.1041711, 37.3503984], [127.1041567, 37.3503406], [127.104149, 37.3503018], [127.1041357, 37.3502621], [127.1041144, 37.3502278], [127.1040491, 37.3501915], [127.1039624, 37.3501498], [127.1038869, 37.3501162], [127.1037866, 37.3500915], [127.1035371, 37.3500916], [127.1031543, 37.3500921], [127.1031249, 37.350092], [127.1031001, 37.3500928], [127.1023741, 37.3500913], [127.102137, 37.3500914], [127.1019122, 37.3501077], [127.1014833, 37.350091], [127.0994651, 37.3499643], [127.0983477, 37.3498938], [127.0982134, 37.3498807], [127.0952894, 37.3496012], [127.0947139, 37.3495479], [127.0943562, 37.3495151], [127.0939815, 37.3494796], [127.093117, 37.3494009], [127.0926068, 37.3493775], [127.0923652, 37.349374], [127.0919406, 37.3493878], [127.0915554, 37.3494243], [127.0912447, 37.3494701], [127.0908976, 37.3495429], [127.0903062, 37.3497058], [127.0901287, 37.3497619], [127.0900495, 37.3497923], [127.0897077, 37.3499344], [127.0893591, 37.3501009], [127.0888664, 37.3503759], [127.0885038, 37.3506135], [127.0876346, 37.3511919], [127.0873264, 37.3513873], [127.0869617, 37.3515934], [127.0866186, 37.3517679], [127.0862802, 37.3519254], [127.0860142, 37.3520389], [127.0858389, 37.3520915], [127.0857428, 37.35212], [127.085632, 37.3521512], [127.0852847, 37.3522653], [127.0848098, 37.3523844], [127.0846662, 37.3524128], [127.0846493, 37.3524163], [127.0841497, 37.3525155], [127.0831843, 37.3527131], [127.0816741, 37.3530197], [127.0809673, 37.3532209], [127.0803792, 37.3533919], [127.0799572, 37.3535382], [127.0798112, 37.3535891], [127.079327, 37.3537649], [127.078932, 37.3539357], [127.0783114, 37.354258], [127.0772117, 37.3548408], [127.0756753, 37.3557746], [127.0730757, 37.3574211], [127.0706967, 37.3589583], [127.0698295, 37.359542], [127.0696573, 37.3596513], [127.0686061, 37.3604137], [127.0678917, 37.3609321], [127.0676434, 37.3611123], [127.0675947, 37.3611338], [127.0675732, 37.3611436], [127.0674226, 37.3612107], [127.0671995, 37.3613324], [127.0671723, 37.3613441], [127.0671485, 37.3613548], [127.0670625, 37.3613914], [127.0668996, 37.3614332], [127.0667086, 37.3614559], [127.0664625, 37.3614577], [127.0663169, 37.3614347], [127.0662042, 37.3614063], [127.065452, 37.3612278], [127.0648088, 37.3611335], [127.064731, 37.3611224], [127.0639068, 37.3610932], [127.0630743, 37.3611379], [127.0625694, 37.361164], [127.0621152, 37.3612047], [127.0619252, 37.361249], [127.061726, 37.3613231], [127.0615889, 37.3614019], [127.0614492, 37.3615411], [127.061375, 37.3616833], [127.0613619, 37.3617995], [127.0613867, 37.3619997], [127.0614615, 37.3621415], [127.0615367, 37.3622247], [127.0616244, 37.3622827], [127.061763, 37.3623481], [127.0619865, 37.3623579], [127.0621119, 37.3623575], [127.0622, 37.3623497], [127.0623494, 37.3622908], [127.0624367, 37.3622325], [127.0625242, 37.3621328], [127.0625676, 37.3620446], [127.0626285, 37.3618628], [127.0626693, 37.361652], [127.0626803, 37.3615141], [127.0629104, 37.3586369], [127.0629946, 37.3583271], [127.0630304, 37.3579964], [127.0630495, 37.3578216], [127.0630662, 37.3576703], [127.0632105, 37.3563449], [127.0632391, 37.3556996], [127.0632575, 37.3552372], [127.0632642, 37.354865], [127.0632371, 37.3542799], [127.0631874, 37.3536992], [127.0631239, 37.3531663], [127.0629868, 37.3526664], [127.0626748, 37.3517494], [127.0625578, 37.3514822], [127.0609309, 37.3477751], [127.0607867, 37.3475159], [127.0603117, 37.3465081], [127.0599693, 37.3457795], [127.0596747, 37.3449878], [127.059418, 37.3442955], [127.0593447, 37.3440744], [127.0589705, 37.3428237], [127.0589091, 37.3425026], [127.0587921, 37.3418495], [127.0586517, 37.340963], [127.0586495, 37.3409521], [127.0585992, 37.3406653], [127.0585522, 37.3404019], [127.0585074, 37.3401476], [127.0583893, 37.3395071], [127.0582682, 37.338782], [127.0582569, 37.3385881], [127.0582124, 37.3373305], [127.058227, 37.33676], [127.0582825, 37.3355758], [127.0583323, 37.3351623], [127.0584198, 37.3344802], [127.058641, 37.3333327], [127.0586709, 37.3330462], [127.0587783, 37.3310888], [127.0587777, 37.331004], [127.0587542, 37.3307777], [127.0587435, 37.3306758], [127.0584369, 37.3282914], [127.0582911, 37.3277419], [127.0582822, 37.3277121], [127.0582745, 37.3276833], [127.0576332, 37.3259808], [127.0574918, 37.3256387], [127.0573614, 37.3253579], [127.0570753, 37.3248782], [127.0568886, 37.3245656], [127.0561369, 37.3234081], [127.0551926, 37.3220083], [127.0550639, 37.3218185], [127.0545006, 37.3208835], [127.0541911, 37.3203523], [127.0539435, 37.3198484], [127.053754, 37.3194411], [127.0536305, 37.3191396], [127.0534169, 37.3186187], [127.0533294, 37.3183498], [127.0533149, 37.3183073], [127.0531491, 37.3177235], [127.0530897, 37.3174709], [127.0530742, 37.317405], [127.0529415, 37.3161922], [127.0528323, 37.3151993], [127.0526612, 37.3139728], [127.0527291, 37.3129969], [127.052765, 37.3126391], [127.0528309, 37.3121869], [127.0528772, 37.311996], [127.0531063, 37.3110387], [127.0531375, 37.3109162], [127.0535278, 37.309799], [127.0537247, 37.3093193], [127.0537992, 37.309133], [127.0541248, 37.3084582], [127.0544603, 37.3078195], [127.0544774, 37.3077925], [127.0553923, 37.3063114], [127.0556247, 37.3059355], [127.0559264, 37.3054859], [127.0567437, 37.304264], [127.0568189, 37.3041507], [127.0577779, 37.3026237], [127.0584704, 37.3015194], [127.0587114, 37.3012147], [127.0590604, 37.3007789], [127.0593961, 37.3002934], [127.0598926, 37.2995119], [127.0603901, 37.2987422], [127.0605097, 37.2985533], [127.0607124, 37.2982305], [127.0614458, 37.2970749], [127.0623351, 37.2956657], [127.0624604, 37.2954715], [127.0634497, 37.293931], [127.0635579, 37.2937557], [127.0635648, 37.293744], [127.0644202, 37.2923328], [127.0645569, 37.2921116], [127.0646559, 37.2919569], [127.0647539, 37.2917977], [127.0649088, 37.2915423], [127.0650146, 37.2913859], [127.0651569, 37.291161], [127.0655771, 37.2904965], [127.0663886, 37.2892573], [127.0667847, 37.2886449], [127.0670136, 37.2882609], [127.0670569, 37.2881916], [127.0684379, 37.2859891], [127.0692451, 37.2847004], [127.0695817, 37.2842437], [127.0699225, 37.2838267], [127.0701689, 37.2835373], [127.0703393, 37.2833297], [127.0704244, 37.2832354], [127.0707174, 37.2829075], [127.0710292, 37.2826129], [127.0711879, 37.2824774], [127.0717034, 37.2820944], [127.0720093, 37.2818665], [127.0720297, 37.2818504], [127.0724497, 37.2815743], [127.0735477, 37.2809121], [127.0736371, 37.2808583], [127.0742516, 37.2805135], [127.0744992, 37.280408], [127.0752851, 37.2800674], [127.0760561, 37.2797745], [127.0779741, 37.2791107], [127.078572, 37.2788884], [127.0790784, 37.2787], [127.0794435, 37.278567], [127.0797363, 37.2784599], [127.080078, 37.2782637], [127.0817882, 37.2776379], [127.081994, 37.2775494], [127.0822737, 37.2773484], [127.0823905, 37.2772425], [127.0824814, 37.2771157], [127.082568, 37.2769556], [127.0826172, 37.276825], [127.0826382, 37.2766989], [127.0826501, 37.2765881], [127.0826122, 37.2763166], [127.0824739, 37.2760259], [127.0821727, 37.2756219], [127.082139, 37.275592], [127.0820672, 37.2755278], [127.0819243, 37.2754606], [127.081753, 37.2754393], [127.0811568, 37.275539], [127.0808032, 37.2756513], [127.0806947, 37.275678]];
        // 지도를 클릭했을 때 발생하는 이벤트를 받아 파노라마 위치를 갱신합니다. 이때 거리뷰 레이어가 있을 때만 갱신하도록 합니다
        naver.maps.Event.addListener(map, 'click', function (e) {
            if (streetLayer.getMap()) {
                for (let index = 0; index < arr.length; index++) {
                    setTimeout(() => {
                        var latlng = arr[index];
                        console.log(latlng);
                        // 파노라마의 setPosition()은 해당 위치에서 가장 가까운 파노라마(검색 반경 300미터)를 자동으로 설정합니다.
                        pano.setPosition(latlng);
                    }, index * 1000)
                }
            }
        });
        
        var polyline = new naver.maps.Polyline({
            path: arr,      //선 위치 변수배열
            strokeColor: '#FF0000', //선 색 빨강 #빨강,초록,파랑
            strokeOpacity: 0.8, //선 투명도 0 ~ 1
            strokeWeight: 6,   //선 두께
            map: map           //오버레이할 지도
        });
        var marker = new naver.maps.Marker({
            position: new naver.maps.LatLng(37.3595704, 127.105399),
            map: map
        });
    </script>
</body>
<script type='module' src='/src/hello.js'></script>

</html>